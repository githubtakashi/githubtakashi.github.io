# Visual Studio 2005を習得するためのメモ

メルカリで入手したvisual studio 2005 standard editionを使って勉強していく際のメモを

書いていきます。

なぜ2021年にvisual studio 2005を使うかというと、c++を使ったアプリを作れるようになりたい

のはもちろん、古いthinkpad使うためが一番の目的かも。

好きな古いthinkpadを使いたいけど、ネット接続は危険なのでしないので、ネットにつながずと

なると、文書作成したり、コマンドプロンプトやバッチファイルの書き方を勉強するくらいしか使い道が

思いつきません。

visual studioを使うことでレトロな世代のthinkpadを使う口実になるし、サポートがすでに打ち切りになっている

ので使い道が少ない、レトロなwindowsを有意義に使うことができる。

visual studio 2005はwindows2000～xpまでのOSで使えるらしいので、

windows xpのthinkpad T42にvisual studio 2005をインストールしました。

<br />

## visual studio 2005を使って勉強進める際の問題点

問題点は、2000年代前半のvisual studioなのでバージョンが古く、visual studio2005の情報がネット上に

ほとんど転がっていないこと。

僕が検索した限り、さすがに16年くらい前はがっつりvisual studioの使い方など実用的な

記事作っていた方は少ないようです。

なのでほとんどネット上の情報に頼ることができない。

また、互換性の問題も大きいです。わざわざ昔の仕様のプログラミング環境を使おうとするので、些細なことでも書き方が今と違ったりするので

新しいバージョンのvisual studioの情報では分からないことを解決できそうにありません。

<br />

## MSDNライブラリを活用する

cd-romからインストールしたMSDNライブラリに充実した内容のコンテンツがいっぱいあるので、

MSDNライブラリを活用するのが一番よさそう。

チュートリアルもあるので、まずはチュートリアルを進めて覚えていくことがよさそう。


## 用語など

dllはよく目にするけど、何なのかすぐ忘れる

### DLL

Dynamic Link Library(動的リンクライブラリ)

DLLとは、Windowsのプログラムファイルの種類のひとつ。いろいろなプログラムから利用される汎用性の高い機能が収録された、

部品化されたプログラム。拡張子は.dll

動的リンクライブラリという名前のとおり、実行時に必要なファイルを動的にリンクする。

動的リンクは実行ファイルから参照されるライブラリなどを実行時に連結する。

実行環境側でライブラリを用意する必要があるが実行ファイル本体を軽量にでき、

本体のみやライブラリのみなどといった、依存性が低いので部分的な修正や更新がやりやすい。

静的リンクの場合は、リンカは参照される関数全部をstatic link libraryから取得して実行コード内に配置

する。一方、dllの動的リンクは実行時での必要な情報だけ含めることが可能なので、メモリの節約など利点が多い。

<br />

### スタティックライブラリ

dllはプログラムの実行時に合体させるライブラリとは対照的に、

スタティックライブラリはプログラムを作成するときにプログラムと合体させるライブラリのこと。

<br />

### ビルドしたときにメッセージで出てくるマニフェストとは

ビルドしたアプリケーションのランタイム依存について書かれたドキュメントをマニフェストという.

外部ファイルか、ニーモックで書かれたアセンブリか、アプリ内に埋め込まれる。

<br />

### シンボルとは

プログラムデータベースファイル(.pdb)のことをシンボルファイルと呼ぶ。

プログラムデータベースファイルとは、デバッグ時に作成されるファイルのことで、

ソースコードをコンパイル時にソースコードからpdbファイルが作られる。

pdbファイルには、プログラムに関するデバッグ情報とプログラムの状態が保持されている。

<br />

## windows フォームコントロール

windowsのwindowの枠内に表示、機能させることができるアプリケーション

windowsフォームアプリケーション(共通言語ランタイムを対象にするGUIアプリケーション)に配置されるコンポーネントのことを

フォームコントロールという。

<br />

## CLRとは

Common Language Runtime(共通言語ランタイム)の略で、.net applicationを実行するためのバーチャルマシンのこと。

.net applicationとは、マイクロソフトが開発したアプリ開発や実行環境のこと。

CLRがマネージドコードの取得とコンパイルと実行を行う。

マネージドコードとは、実行がCLRによって管理されているコードのこと。

<br />

## マネージアセンブリとは

マネージドコードで部品化した機能を持つプログラムを作成し、部品化することで、他で参照して使う。

作成するプログラムごとにいちいち実装するのではなく、マネージアセンブリを作っておくと他のアプリケーションから

マネージアセンブリを機能として参照して使える。

CLR(共通言語ランタイム)の環境を前提とした部品プログラムをマネージアセンブリと呼ぶ。

<br />

## プリコンパイル済みヘッダーファイルとは

ヘッダーファイルまたはヘッダーファイルに含まれるファイルの内容が変更された場合のみ

コンパイルされる機能のこと。

コンパイル時間を短くしてくれるのでビルド時間が短くなる。

すでにコンパイルが通っていて変更がなく安定しているコードについては解析の対象から除外

することで、コンパイル時間が短縮される。

<br />

## ref修飾子とは

参照渡しにできる修飾子

```
public ref class MyMathFuncs {//method...}
```

<br />

## gcnewとは

CLR環境で使う。参照渡し、値渡しのデータに対してマネージド型のメモリが割り当てられ、

ガベージコレクションによって自動的にメモリが解放される。

```
if (b == 0)
{
  thwow gcnew DivideByZeroException("b cannot be Zero!");
}
```

<br />

## COMとは

component object modelとは、マイクロソフトによる、ソフトウェアの機能を部品化して外部から呼び出して利用する仕組みのこと。

OSやプログラミング言語に依存しないので、様々な言語やOSで開発されたプログラムを連携できる。

部品化された（単体では動作しない）ソフトウェアをCOMコンポーネントと呼ぶ。

アプリケーションに組み込むことで、その機能を呼び出し、利用できる。

<br />

## COMサーバーとは

アプリケーションソフトウェアはCOMインターフェースを介してCOMコンポーネントと

通信を行う。COMコンポーネントを提供するものがCOMサーバー。

ググっても説明が見当たらないのでこんな感じのイメージ。

<br />

## ATL(Active Template Library)とは

COM開発を簡単にするためのラッパーライブラリ。

<br /> 

## MFC(Microsoft Foundation Classes)とは

Visual C++でのWindows用のアプリ構築するときに利用するクラスライブラリ。

ATLと一緒にVisual Studioに同梱されるライブラリ。

一般的にアプリでよく使われるクラスが準備されている。

<br />

## __declspec(dllexport)

dll作成の時にメソッド宣言に付ける。
dllをエクスポートして他のアプリケーションで使えるようにするために付加する修飾子。

<br />

## visual C++ /EHsc

/EHscはコンパイラに対して例外処理を有効化するためのオプション。

<br />

## visual c++ /LD

/LDオプションはDLLを作成するために必要なオプション。

visual studioのメニューでdllになるようにビルド設定してビルドすると自動的に/LDオプションでdllが作成される。

コマンドラインからビルドするときは/LDコンパイラオプションを使用し出力ファイルがdllになるようにする。


<br />

## <stdexcept>ヘッダーファイル

stdexceptヘッダをインクルードすると標準的な例外処理のクラスが使えるようになる。
  
```
#include <stdexcept>
using namespace std;
```
  
std名前空間で使えるのでusing namespace stdを宣言する必要がある。
  
<br />
  
## stdafx.hヘッダーファイルとは

プリコンパイル済みヘッダーファイルのこと。
visual c++のプロジェクトのcppファイルにデフォルトで書かれている。
  
<br />























